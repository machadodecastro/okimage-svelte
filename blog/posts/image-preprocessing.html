<!DOCTYPE html>
<html data-wf-domain="moon-template.webflow.io" data-wf-page="5e4b19aa01d14dc2df4eabe4" data-wf-site="5e4b19aa01d14d49bd4eabde" data-wf-status="1">
    <head>
        <meta charset="utf-8"/>
        <title>MachinableAI - Image Preprocessing</title>
        <meta charset="UTF-8">  
        <meta name="description" content="Free app for Data Augmentation Image Preprocessing">
        <meta name="keywords" content="Data Augmentation, Computer Vision, Image Preprocessing, Grayscale, Rotate, Resize, Flipping, Edge Cascade">
        <meta name="author" content="Igor Machado de Castro">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="../assets/img/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
        <link href="../assets/css/main.css" rel="stylesheet" type="text/css"/>
        <script src="../assets/js/main.js" type="text/javascript"></script>
        <!-- Themify Icons-->
	    <link rel="stylesheet" href="../../css/themify-icons.css">
        <script type="text/javascript">WebFont.load({  google: {    families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Fjalla One:regular"]  }});</script>
        <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
    </head>
    <body>
        <div class="sidebar-column">
            <div class="navigation-bar w-nav" data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner">
                <div class="w-container"><a class="logo-link w-nav-brand" href="#">
                    <a class="navbar-brand logo" href="../../index.html">
                        <img src="../assets/img/logo-dark.png" class="logo">
                    </a>
                    <nav class="navigation-menu w-nav-menu" role="navigation">
                        <p class="main-subheading w-hidden-medium w-hidden-small w-hidden-tiny">
                            Blog about researches, products, codes and tips about Artificial Inteligence and so on
                        </p>
                        <div class="divider w-hidden-medium w-hidden-small w-hidden-tiny"></div>
                        <a aria-current="page" class="nav-link w-nav-link w--current" href="../index.html">
                            All posts
                        </a>
                        <div class="divider"></div>
                        <div class="social-link-group">
                            <a class="social-icon-link w-inline-block" target="_blank" href="https://www.linkedin.com/company/machinableai/"><img alt="" src="https://assets.website-files.com/5e4b19aa01d14d49bd4eabde/5e4b19aa01d14d15664eac6c_social-09-white.svg" width="25"/>
                            </a>
                        </div>
                        <div class="divider"></div>
                        <a href="https://www.buymeacoffee.com/igormcastro" target="_blank">
                            <img src="../assets/img/white-button.png" class="buymeacoffee">
                        </a>
                    </nav>
                    <div class="menu-button w-nav-button">
                        <div class="w-icon-nav-menu">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="w-container">
                <div class="post-title-section">
                    <h1>
                        Image Preprocessing for Computer Vision
                    </h1>
                    <div class="post-info-wrapper">
                        <div class="post-info">
                            September 10, 2022
                        </div>
                        <div class="post-info">|</div><a class="post-info when-link" href="#">Computer Vision</a>
                    </div>
                </div>
                <div class="body-copy w-richtext">
                    <p class="post-summary">
                        <img src="../../images/blog/post-1.jpg" />                                           
                    </p>
                    <p>Computer Vision is an umbrella term, where various tasks make up this sub-area of Artificial Intelligence. One of these tasks is Image Processing.</p>
                    <p>The image processing has an image as input and the output is a set of numerical values that will serve as the basis for Computer Vision solutions with the objective of optimizing the machine learning model and consequently the final result of the solution.</p>
                    <p>The process from Image Processing to the field of Computer Vision can be 
                        basically divided into 3 levels:</p>

                        <p><b>Low Level:</b> Operations such as noise reduction or contrast enhancements</p>
                        <p><b>Medium Level:</b> Operations such as segmentation or classification</p>
                        <p><b>High Level:</b> operations such as cognition associated with human vision</p>
                        
                        <p>Image Processing facilitates the "reading" of the image by the algorithms 
                            in order to improve the image quality and, consequently, optimize the 
                            final result.</p>
                        
                        <p>Below are some basic operations in image preprocessing:</p>

                        <h2>Grayscale</h2>
                        <p>The Grayscale color space has only 1 color channel. The RGB (Red, Green, Blue) color space has 3 color channels. The color channel applied to each pixel in the image. That is, in Grayscale mode each image pixel has 1 color channel. In RGB color images, each pixel has 3 color channels.
                            In general, the transformation of the image to Grayscale will facilitate the mathematical pre-processing, since treating RGB pixel images has 3 channels of cores, it requires much more processing than treating in grayscale, where each pixel image has only 1 channel.</p>
                        
                        <p>First, install <b>OpenCV</b>. You also need install 
                            <a target="_blank" href="https://pypi.org/project/numpy/"><b><i class="ti-new-window"></i> numpy</b></a> with <b>pip</b>:                            
                            <pre>
                                <code>
                                    pip install numpy
                                </code>
                            </pre>
                        </p>                                                
                        
                        <p>After that, we need to import the cv2 module, which will make the OpenCV functionalities available:
                            <pre>
                                <code>
                                    import cv2
                                </code>    
                            </pre>
                        </p>

                        <p>Now we create a variable and tell it the path of the image we want to convert:
                            
                            <pre>
                                <code>
                                    image = cv2.imread(<span class="code-example">'C:/Users/YourUser/image.jpg'</span>)
                                </code>
                            </pre>
                        </p>

                        <p>
                            Next, we want to convert the image to gray scale. To do it, we need to call the cvtColor function, which allows to convert the image from a color space (colored image with 3 channels) to another (gray scaled image with 1 channel).
                            As first parameter, this function receives the original image. As second one, it receives the color space conversion code. As we want to convert our original image from RGB (BGR - Blue Green Red) color space to gray, we use the code COLOR_BGR2GRAY:
                            <pre>
                                <code>
                                    gray_image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
                                </code>
                            </pre>                            
                        </p>							

                        <p>
                            Now, to display the images, we call the imshow function of the cv2 module:
                            <pre>
                                <code>
                                    cv2.imshow('Gray image', gray_image)
                                </code>
                            </pre>                            
                        </p>							

                        <p>
                            Finally, the waitKey function waits for a keyboard event. This function receives as input a delay (in milliseconds). Nonetheless, when we pass the value 0, it will wait indefinitely until a key event occurs.
                            So, once the user presses any key, cv module calls the destroyAllWindows function, which will destroy all created windows:
                            <pre>
                                <code>
                                    cv2.waitKey(0)
                                    cv2.destroyAllWindows()
                                </code>
                            </pre>                            
                        </p>
                        
                        <p>The complete code:
                            <pre>
                                <code>
                                    import cv2
    
                                    image = cv2.imread(<span class="code-example">'C:/Users/YourUser/image.jpg'</span>)
                                    gray_image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
                                    
                                    cv2.imshow('Gray image', gray_image)
                                    
                                    cv2.waitKey(0)
                                    cv2.destroyAllWindows()
                                </code>
                            </pre>                            
                        </p>

                        <h2>Rotate and Resize</h2>
                        <p>
                            They are geometric transformations in the image. Rotating the image by 45º, 90º, 180º or 270º or resizing its size serve to improve Computer Vision results, working as Data Augmentation techniques, as well as other operations.

                            Below are examples with the OpenCV library:
                            <pre>
                                <code>
                                    import cv2
    
                                    image = cv2.imread(<span class="code-example">'C:/Users/YourUser/image.jpg'</span>)
    
                                    # rotate image 45 degrees
                                    # image dimensions and calculate the image's center
                                    (h, w) = image.shape[:2]
                                    center = (w // 2, h // 2)
                                    
                                    Matrix = cv2.getRotationMatrix2D(center, 45, 1.0)
                                    rotated_45_image = cv2.warpAffine(image, Matrix, (w, h))
                                    cv2.imshow('Rotate 45º', rotated_45_image) 
    
                                    # rotate image 90 degrees
                                    rotated_90_image = cv2.rotate(image, cv2.cv2.ROTATE_90_CLOCKWISE)
                                    cv2.imshow('Rotate 90º', rotated_90_image)
    
                                    # rotate image 180 degrees
                                    rotated_180_image = cv2.rotate(image, cv2.cv2.ROTATE_180)
                                    cv2.imshow('Rotate 180º', rotated_180_image)
    
                                    # rotate image 270 degrees
                                    rotated_270_image = cv2.rotate(image, cv2.cv2.ROTATE_90_COUNTERCLOCKWISE)
                                    cv2.imshow('Rotate 270º', rotated_270_image)							
                                    
                                    cv2.waitKey(0)
                                    cv2.destroyAllWindows()
                                </code>
                            </pre>                            
                        </p>
                        
                        <p>
                            Now, resizing example:
                            <pre>
                                <code>
                                    import cv2
    
                                    # image dimensions that you want
                                    width = 30
                                    height = 30
    
                                    image = cv2.imread(<span class="code-example">'C:/Users/YourUser/image.jpg'</span>)
    
                                    resize_image = cv2.resize(image, (width,height))
    
                                    cv2.imshow('Resized image', resize_image) 
                                    cv2.waitKey(0)
                                    cv2.destroyAllWindows()
                                </code>
                            </pre>                            
                        </p>
                        
                        <h2>Enhancement</h2>
                        <p>
                            Mathematical operation on pixels, changing the degrees of brightness and contrast of the image in order to enhance the image. Each pixel has its location in the image determined through the X and Y coordinates and, depending on the color channels used, the value of each pixel will present 3 combinations for RGB images (value 1, value 2, value 3) or 1 combination for Grayscale (only one value):
                            <pre>
                                <code>
                                    import cv2
    
                                    # values that you want
                                    contrast = 2
                                    brightness = 5       
    
                                    image = cv2.imread(<span class="code-example">'C:/Users/YourUser/image.jpg'</span>)
    
                                    enhanced_image = cv2.convertScaleAbs(image, alpha=contrast, beta=brightness)
                                    
                                    cv2.imshow('Enhancement', enhanced_image) 				
                                    
                                    cv2.waitKey(0)
                                    cv2.destroyAllWindows()
                                </code>
                            </pre>                            
                        </p>
                    </div><div class="button-wrapper">
                        <a class="button w-button" href="../index.html">← View all posts</a>
                    </div>
                </div>
            </div>
        </div>
        <script src="../assets/js/menu.js" type="text/javascript"></script>
        <script src="../assets/js/menu-2.js" type="text/javascript"></script>
        <!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
    </body>
</html>
